---
title: 'GitHub Actions æ„å»ºã€éƒ¨ç½² Next.jsé¡¹ç›®'
author: 'J.sky'
time: '2023-08-23T16:37:38.846176Z'
tag: 'Next.js'
description: 'å›½å†…è¿æ¥GitHubçš„é€Ÿåº¦çœŸæ˜¯å–œäººï¼Œæ‰€ä»¥æµ‹è¯•GitHub Actionsæ€»æ˜¯å†é‡å¤çš„pushè¿æ¥å¤±è´¥ä¸­ç…ç†¬ï¼Œå¥½åœ¨æœ€åå®è·µé€šè¿‡äº†ï¼Œè®°å½•ä¸€ä¸‹è¿™é‡Œçš„å‘ã€‚'
---

å›½å†…è¿æ¥GitHubçš„é€Ÿåº¦çœŸæ˜¯å–œäººï¼Œæ‰€ä»¥æµ‹è¯•GitHub Actionsæ€»æ˜¯å†é‡å¤çš„pushè¿æ¥å¤±è´¥ä¸­ç…ç†¬ï¼Œå¥½åœ¨æœ€åå®è·µé€šè¿‡äº†ï¼Œè®°å½•ä¸€ä¸‹è¿™é‡Œçš„å‘ã€‚

## Actionsä»£ç 

GitHub Actions çš„é…ç½®æ–‡ä»¶å«åš workflow æ–‡ä»¶ï¼Œå­˜æ”¾åœ¨ä»£ç ä»“åº“çš„ .github/workflowsç›®å½•ä¸­ï¼Œè¿™é‡Œå¤åˆ¶ä½¿ç”¨çš„ä¸€ä½å‰è¾ˆçš„ä»£ç ï¼Œé™¤äº†ä¿®æ”¹äº†pnpmçš„ç‰ˆæœ¬æ„å¤–ï¼Œå…¶ä»–åŸºæœ¬ä¸Šæ²¡æœ‰ä¿®æ”¹ï¼Œä»£ç å¦‚ä¸‹ï¼š

    name: Actions CI - Next.js version 12 static site export, GitHub Actions Build and Deploy
    on:
    push:
        branches: [ master ]
    # æ‰§è¡Œçš„ä¸€é¡¹æˆ–  å¤šé¡¹ä»»åŠ¡
    jobs:
    build-and-deploy:
        # è¿è¡Œåœ¨è™šæ‹Ÿæœºç¯å¢ƒubuntu-latest
        # https://docs.github.com/zh/actions/using-workflows/workflow-syntax-for-github-actions#jobsjob_idruns-on
        runs-on: ubuntu-latest
        steps:
        - name: è·å–æºç   ğŸ›ï¸
            uses: actions/checkout@v3
        - name: Nodeç¯å¢ƒç‰ˆæœ¬ ğŸ—œï¸
            uses: actions/setup-node@v3
            with:
            node-version: 18
        - name: å®‰è£… Pnpm ğŸ§¬
            uses: pnpm/action-setup@v2
            id: pnpm-install
            with:
            version: 8
            run_install: true
        - name: å®‰è£…ä¾èµ– âš™ï¸
            run: pnpm install
        - name: æ‰“åŒ… ğŸ—ï¸
            run: |
            npm run build
            touch out/.nojekyll
        - name: éƒ¨ç½² ğŸš€
            uses: JamesIves/github-pages-deploy-action@v4
            with:
            branch: gh-pages
            folder: out
            clean: true


ç›®å‰æ¥è¯´ï¼Œè¿™æ®µä»£ç ç®€æ´è€Œä¸”è¿‡ç¨‹æ¸…æ™°ï¼Œå¦‚æœæœ‰ç‰¹åˆ«çš„è¦æ±‚å¯ä»¥æŒ‰è‡ªå·±çš„éœ€æ±‚ä¿®æ”¹ã€‚

## ä¸€äº›å‘

1. æƒé™é—®é¢˜

    Error: The deploy step encountered an error: The process '/usr/bin/git' failed with exit code "128"  âŒ Notice: Deployment failed! âŒ

åŸºæœ¬ä¸Šéƒ½åŠ¨ä½œé€šè¿‡äº†ï¼Œçªç„¶å‡ºç°è¿™ä¸ª128ï¼Œå…¶å®æ˜¯æƒé™é—®é¢˜ï¼Œè§£å†³æ–¹æ³•ï¼š

[ç‚¹å‡»æŸ¥çœ‹](https://github.com/actions/checkout/issues/417#issuecomment-1427951779)

![åšå®¢åç§°](https://suiyan.cc/assets/images/2023/git128.webp)

2. Nexté¡¹ç›®çš„é™æ€æ–‡ä»¶èµ„æºåœ°å€æ­£ç¡®ï¼Œå´æ— æ³•æ‰“å¼€æ˜¾ç¤º404ï¼Œä¿®æ”¹æ–¹æ³•ï¼šé™æ€æ–‡ä»¶çš„æ ¹ç›®å½•æ·»åŠ `.nojekyll`çš„ç©ºæ–‡ä»¶å³å¯ã€‚
3. å¦‚æœé¡¹ç›®ä¿å­˜å†åŸŸåçš„ä¸‹ä¸€çº§ç›®å½•ï¼Œå¯ä»¥è€ƒè™‘åœ¨nextçš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š


        #next.config.js
        
        basePath: '/ç›®å½•åç§°',


##  æ€»ç»“

å…¶å®å¾ˆç®€å•ï¼Œä½†æ˜¯æµ‹è¯•çš„æ—¶å€™ç”±äºç½‘é€Ÿé—®é¢˜é€ æˆçš„å¾ˆè´¹æ—¶é—´ï¼Œæ‰€ä»¥è°ƒè¯•çš„æ—¶å€™å°½é‡è¦çœ‹ä»”ç»†å“ˆã€‚


ç›¸å…³è¿æ¥ï¼š

[æµ‹è¯•é¡¹ç›®åœ°å€ï¼ŒåŒ…å«æ‰€æœ‰ä»£ç ](https://github.com/bosichong/githubactionstest)

[ä½¿ç”¨ GitHub Actions æ„å»ºã€éƒ¨ç½² Next.js å¹¶å°†å…¶æ‰˜ç®¡åˆ° GitHub Pages](https://juejin.cn/post/7220410343649624121)